(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{145:function(e,t,a){e.exports=a(381)},153:function(e,t,a){},16:function(e,t,a){},381:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(137),c=a.n(s),o=(a(150),a(153),a(3)),i=a(4),l=a(8),u=a(6),d=a(7),m=a(5),f=(a(16),function(){return{type:"SHOW_OVERLAY"}}),h=function(){return{type:"HIDE_OVERLAY"}},p=function(){function e(){Object(o.a)(this,e)}return Object(i.a)(e,null,[{key:"getSelectedCards",value:function(e){return e.filter(function(e){return null!==e&&!e.faceDown})}},{key:"getMatches",value:function(t,a,n){var r=null===n.count;return t.attrs.forEach(function(e,t){var s=a.attrs[t];r?e===s&&(n.attrs[t]=e):null!==n.attrs[t]&&n.attrs[t]!==s&&(n.attrs[t]=null)}),n.count=0,n.matchingAttrs=[],n.attrs.forEach(function(t,a){null!==t&&(n.count++,n.matchingAttrs.push(e.attrs[a].name))}),n}},{key:"shuffleDeckCards",value:function(){for(var t=[],a=e.attrs[0].values.length,n=e.attrs[0].values.length,r=e.attrs[0].values.length,s=e.attrs[0].values.length,c=0;c<a;c++)for(var o=0;o<n;o++)for(var i=0;i<r;i++)for(var l=0;l<s;l++){var u={attrs:[c,o,i,l],key:e.getKey(c,o,i,l),faceDown:!0,index:null};t.push(u)}for(var d=Math.floor(50*Math.random())+10,m=0;m<d;m++)this.shuffleArray(t);return t}},{key:"getCardFromKey",value:function(e,t){var a=e.find(function(e){return null!==e&&e.key===t});return a||null}},{key:"decodeAttr",value:function(t,a){var n,r,s={index:null,name:null};return"string"===typeof a?-1!==(n=e.attrs[t].values.indexOf(a.toLowerCase()))&&(s={index:n,name:r=e.attrs[t].name[n]}):(n=a,"undefined"!==typeof(r=e.attrs[t].values[a])&&(s={index:n,name:r})),e.attrs[t].colorMap&&(s.value=e.attrs[t].colorMap[s.name]),s}},{key:"getKey",value:function(e,t,a,n){return"".concat(e).concat(t).concat(a).concat(n)}},{key:"shuffleArray",value:function(e){console.log("Shuffling cards");for(var t=e.length-1;t>=0;t--){var a=Math.floor(Math.random()*(t+1)),n=e[a];e[a]=e[t],e[t]=n}return e}}]),e}();p.attrs=[{name:"color",values:["green","purple","red"],colorMap:{green:"#00C000",purple:"#C000C0",red:"#FF0000"}},{name:"count",values:["1","2","3"],isColor:!1},{name:"shape",values:["diamond","oval","rectangle"],isColor:!1},{name:"pattern",values:["empty","striped","solid"],isColor:!1}],p.attrNames=p.attrs.map(function(e){return e.name}),p.colorAttr=p.attrs.filter(function(e){return"undefined"!==typeof e.colorMap}),p.getMatchingAttrs=function(e,t){var a=p.attrNames,n=e.length;if(n<1)return[];if(1===n)return a;for(var r={attrs:[null,null,null,null],matchingAttrs:[],count:null},s=e[0],c=1;c<n;c++){var o=e[c];if(0===(r=p.getMatches(s,o,r)).count)break}return r.matchingAttrs};var v=function(){return{type:"DEAL_CARDS"}},b=function(){return{type:"CHECK_GAME_OVER"}},g=function(e){return{type:"CARD_FLIPPED",cardKey:e}},E=function(e){return{type:"CHECK_MATCHES",tableCards:e}},C=function(e){return{type:"UPDATE_SCORE_FROM_MATCHES",tableCards:e}},O=function(){return{type:"KEEP_SCORE"}},y=function(){return{type:"RESET_FLIPPED_CARDS"}},k=function(){return{type:"CLEAR_KEPT_CARDS"}};function j(e){return function(t,a){var n=a().score,r=n.tableCards,s=n.possPoints;p.getCardFromKey(r,e).faceDown?t(function(e){return function(t,a){t(g(e));var n=a().score.tableCards;t(E(n));var r=a().score.matchingAttrs;t(C(n));var s=p.getSelectedCards(n),c=1===s.length||r.length>0;c||(t(f()),setTimeout(function(){t(y()),t(h())},2e3))}}(e)):s>0&&t(A())}}function A(){return function(e){e(O()),e(k()),e(f()),setTimeout(function(){e(v()),e(b()),e(h())},300)}}var _=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"onKeepButtonClick",value:function(){this.props.dispatch(A())}},{key:"render",value:function(){var e=this.props.score,t=e.possPoints,a=e.matchingAttrs,n=a?a.join(", "):"",s=this.props.score.deckCards.length;return r.a.createElement("div",{className:"SharedStatus"},r.a.createElement("div",{className:"status-section cards-area"},r.a.createElement("span",{className:"statusTitle ui label"},"Cards Left: "),r.a.createElement("span",{className:"status-count ui basic label"},s)),r.a.createElement("div",{className:"status-section posspoints-area"},r.a.createElement("span",{className:"statusTitle ui label"},"Possible Points: "),r.a.createElement("div",{className:""},r.a.createElement("button",{className:"ui button primary keep-button",tabIndex:"0",disabled:0===t,title:"Keep the possible points. Also you can click on a flipped up card in the set to keep them.",onClick:this.onKeepButtonClick.bind(this)},"Keep"),r.a.createElement("span",{className:"status-count ui basic label"},t))),r.a.createElement("div",{className:"status-section matching-attrs-area"},r.a.createElement("span",{className:"statusTitle ui label"},"Matches: "),r.a.createElement("span",{className:"matching-attrs ui label"},n)))}}]),t}(n.Component);var S=Object(m.connect)(function(e){return{common:e.common,score:e.score}})(_),w=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.user,a=e.sets,n=e.points,s=e.isActive;return r.a.createElement("div",{className:"UserScore","data-isactive":s},r.a.createElement("div",{className:"status-section userArea"},r.a.createElement("span",{className:"statusTitle ui label"},t)),r.a.createElement("div",{className:"status-section setsArea"},r.a.createElement("span",{className:"statusTitle ui label"},"Sets: "),r.a.createElement("span",{className:"status-count ui basic label"},a)),r.a.createElement("div",{className:"status-section points-area"},r.a.createElement("span",{className:"statusTitle ui label"},"Points: "),r.a.createElement("span",{className:"status-count ui basic label"},n)))}}]),t}(n.Component),N=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"getUserScores",value:function(){var e=this;return this.props.score.userScores.map(function(t,a){var n=t.user,s=t.sets,c=t.points,o=e.props.score.activeUserIndex===a;return r.a.createElement(w,{key:a,user:n,sets:s,points:c,isActive:o})})}},{key:"render",value:function(){var e=this.getUserScores();return r.a.createElement("div",{className:"StatusArea"},r.a.createElement(S,null),e)}}]),t}(n.Component);var R=Object(m.connect)(function(e){return{common:e.common,score:e.score}})(N),P=a(35),D=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).handleClick=a.handleClick.bind(Object(P.a)(Object(P.a)(a))),a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"handleClick",value:function(){this.props.dispatch(j(this.props.cardKey))}},{key:"render",value:function(){var e=p.decodeAttr(0,this.props.attr1),t=p.decodeAttr(1,this.props.attr2),a=p.decodeAttr(2,this.props.attr3),n=p.decodeAttr(3,this.props.attr4),s=this.props,c=s.isEmpty,o=s.faceDown,i=s.highlight,l="".concat(e.name," ").concat(t.name," ").concat(a.name," ").concat(n.name),u="".concat(e.name,"-").concat(t.name,"-").concat(a.name,"-").concat(n.name,".png");if(c){return r.a.createElement("div",{className:"Card is-empty"},r.a.createElement("img",{alt:"",src:"/images/cards/brave/CardEmpty.png"}))}var d="card back",m="/images/cards/brave/CardBack.png";return o||(d=l,m="/images/cards/brave/".concat(u)),o?r.a.createElement("div",{className:"Card "+i,"data-facedown":o,onClick:this.handleClick},r.a.createElement("img",{src:m,alt:d})):r.a.createElement("div",{className:"Card "+i,"data-facedown":o,"data-card-label":l,onClick:this.handleClick},r.a.createElement("img",{src:m,alt:d}),r.a.createElement("div",{className:"card-label"}))}}]),t}(n.Component);var T=Object(m.connect)(function(e){return{common:e.common,highlight:e.score.highlight}})(D);var M=Object(m.connect)(function(e){return{common:e.common}})(function(e){return e.common.overlayShown?r.a.createElement("div",{className:"Overlay"}):null}),K=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).getCards=function(){a.cards=[],a.props.score.tableCards.forEach(function(e,t){var n=null;if(e){var s=e.key,c=e.attrs,o=e.faceDown;c&&4===c.length?n=r.a.createElement("div",{key:t+"."+s,className:"Table_grid_item"},r.a.createElement(T,{cardKey:s,attr1:c[0],attr2:c[1],attr3:c[2],attr4:c[3],faceDown:o})):(console.log("cardInfo @ index "+t+" = "),console.log(e))}n||(n=r.a.createElement("div",{key:t+".empty",className:"Table_grid_item"},r.a.createElement(T,{isEmpty:!0}))),a.cards.push(n)})},a.cards=null,a.props.deckCards||a.props.dispatch(v()),a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return this.getCards(),this.props.score.gameOver?r.a.createElement("div",{className:"Table"},r.a.createElement(M,null),r.a.createElement("div",{className:"game-over-message"},"Congratulations!",r.a.createElement("br",null),"All possible combinations have been played!"),r.a.createElement("button",{className:"ui button primary new-game-button",onClick:function(){document.location.reload()}},"New Game")):r.a.createElement("div",{className:"Table"},r.a.createElement(M,null),r.a.createElement("div",{className:"Table_grid"},this.cards))}}]),t}(n.Component);var x=Object(m.connect)(function(e){return{common:e.common,score:e.score}})(K),L=a(140),I=a.n(L),H=a(141),U=a.n(H),F=a(48),V=Object(F.createDevTools)(r.a.createElement(U.a,{toggleVisibilityKey:"ctrl-x",changePositionKey:"ctrl-z",defaultIsVisible:!1,defaultPosition:"left"},r.a.createElement(I.a,{theme:"tomorrow"}))),B=a(15),W=a(142),G=a(143),Y=a(9),J={error:null,overlayShown:!1},z=a(144),Q=a(36),$={tableCards:[],deckCards:[],matchingAttrs:[],userScores:[{user:"Player 1",sets:0,points:0},{user:"Player 2",sets:0,points:0}],activeUserIndex:0,possPoints:0,highlight:"none",gameOver:!1},q={common:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_ERROR":return e=Object(Y.a)({},e,{error:t.error});case"CLEAR_ERROR":return e=Object(Y.a)({},e,{error:null});case"SHOW_OVERLAY":return e=Object(Y.a)({},e,{overlayShown:!0});case"HIDE_OVERLAY":return e=Object(Y.a)({},e,{overlayShown:!1});default:return e}},score:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$,t=arguments.length>1?arguments[1]:void 0,a=Object(Y.a)({},e);switch(t.type){case"TEST_REMOVE_BUNCH_OF_CARDS":var n=Math.floor(Math.random()*e.tableCardsCount)+1;console.log("TEST_REMOVE_BUNCH_OF_CARDS: ".concat(n)),a.tableCards.forEach(function(e,t){null!==e&&n-- >0&&(a.tableCards[t]=Object(Y.a)({},e,{index:t,faceDown:!1}))});break;case"DEAL_CARDS":var r=e.deckCards;0===e.tableCards.length?(a.tableCards=new Array(20).fill(null),0===r.length&&(a.deckCards=p.shuffleDeckCards(),r=a.deckCards)):a.tableCards=Object(Q.a)(e.tableCards);var s=0;a.tableCards.forEach(function(e,t){if(null===e){if(r.length>0){var n=r.splice(0,1),c=Object(z.a)(n,1)[0];a.tableCards[t]=Object(Y.a)({},c,{index:t}),s++}}else s++}),a.tableCardsCount=s;break;case"CHECK_GAME_OVER":if(a.gameOver=e.tableCardsCount<2,!a.gameOver){for(var c=!1,o=e.tableCards.length,i=0;i<o&&!c;i++){var l=e.tableCards[i];if(l)for(var u=i+1;u<o&&!c;u++){var d=e.tableCards[u];if(d){console.log("CHECK_GAME_OVER: card1: "),console.log(l),console.log("CHECK_GAME_OVER: card2: "),console.log(d);var m=[l,d],f=p.getMatchingAttrs(m);f&&f.length>0&&(c=!0)}}}a.gameOver=!c}break;case"CARD_FLIPPED":var h=t.cardKey,v=e.tableCards,b=p.getCardFromKey(v,h);if(null!=b){var g=Object(Q.a)(v),E=Object(Y.a)({},b,{faceDown:!b.faceDown});g[E.index]=E,a.tableCards=g}break;case"CHECK_MATCHES":var C=t.tableCards,O=p.getSelectedCards(C),y=Object.keys(O).length,k=p.getMatchingAttrs(O),j=k.length>0;a.highlight=j?"highlight-match":"highlight-mismatch",a.matchingAttrs=j&&y>1?k:[];break;case"UPDATE_SCORE_FROM_MATCHES":var A=t.tableCards,_=p.getSelectedCards(A);if(e.matchingAttrs.length>0){var S=Object.keys(_).length,w=S*S;a.possPoints=w}else a.possPoints=0;break;case"INCREMENT_SCORE":"undefined"!==typeof t.sets&&(a.sets+=t.sets),"undefined"!==typeof t.points&&(a.points+=t.points),"undefined"!==typeof t.possPoints&&(a.possPoints+=t.possPoints);break;case"SET_SCORE":"undefined"!==typeof t.sets&&(a.sets=t.sets),"undefined"!==typeof t.points&&(a.points=t.points),"undefined"!==typeof t.possPoints&&(a.possPoints=t.possPoints),"undefined"!==typeof t.matchingAttrs&&(a.matchingAttrs=t.matchingAttrs);break;case"KEEP_SCORE":var N=e.activeUserIndex,R=Object(Y.a)({},e.userScores[N]);"undefined"!==typeof a.possPoints&&(R.points+=e.possPoints,R.sets++,a.userScores=Object(Q.a)(e.userScores),a.userScores[N]=R),a.activeUserIndex=(N+1)%2,a.possPoints=0,a.matchingAttrs=[],a.highlight="none";break;case"RESET_FLIPPED_CARDS":a.possPoints=0,a.matchingAttrs=[],a.tableCards=e.tableCards.map(function(e){return e?Object(Y.a)({},e,{faceDown:!0}):null}),a.activeUserIndex=(e.activeUserIndex+1)%2;break;case"CLEAR_KEPT_CARDS":var P=e.tableCards,D=p.getSelectedCards(P),T=Object(Q.a)(P);D.forEach(function(e){T[e.index]=null}),a.tableCards=T}return a}},X=Object(B.c)(q),Z=Object(W.createLogger)(),ee=Object(B.d)(Object(B.a)(G.a,Z),V.instrument());var te=function(e){function t(e){var a,n;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).store=Object(B.e)(X,n,ee),a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(m.Provider,{store:this.store},r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-header"},r.a.createElement(R,null)),r.a.createElement(V,null),r.a.createElement(x,null)))}}]),t}(n.Component),ae=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function ne(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}c.a.render(r.a.createElement(te,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("","/service-worker.js");ae?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):ne(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):ne(e)})}}()}},[[145,2,1]]]);
//# sourceMappingURL=main.8f2a745c.chunk.js.map