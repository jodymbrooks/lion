(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{145:function(e,t,a){e.exports=a(381)},153:function(e,t,a){},16:function(e,t,a){},381:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(49),s=a.n(c),o=(a(150),a(153),a(3)),l=a(4),i=a(8),u=a(6),d=a(7),m=a(5),h=(a(16),function(){return{type:"SHOW_OVERLAY"}}),f=function(){return{type:"HIDE_OVERLAY"}},v=function(){function e(){Object(o.a)(this,e)}return Object(l.a)(e,null,[{key:"getSelectedCards",value:function(e){return e.filter(function(e){return null!==e&&!e.faceDown})}},{key:"getMatches",value:function(t,a,n){var r=null===n.count;return t.attrs.forEach(function(e,t){var c=a.attrs[t];r?e===c&&(n.attrs[t]=e):null!==n.attrs[t]&&n.attrs[t]!==c&&(n.attrs[t]=null)}),n.count=0,n.matchingAttrs=[],n.attrs.forEach(function(t,a){null!==t&&(n.count++,n.matchingAttrs.push(e.attrs[a].name))}),n}},{key:"shuffleDeckCards",value:function(){for(var t=[],a=e.attrs[0].values.length,n=e.attrs[0].values.length,r=e.attrs[0].values.length,c=e.attrs[0].values.length,s=0;s<a;s++)for(var o=0;o<n;o++)for(var l=0;l<r;l++)for(var i=0;i<c;i++){var u={attrs:[s,o,l,i],key:e.getKey(s,o,l,i),faceDown:!0,index:null};t.push(u)}for(var d=Math.floor(50*Math.random())+10,m=0;m<d;m++)this.shuffleArray(t);return t}},{key:"getCardFromKey",value:function(e,t){var a=e.find(function(e){return null!==e&&e.key===t});return a||null}},{key:"decodeAttr",value:function(t,a){var n,r,c={index:null,name:null};return"string"===typeof a?-1!==(n=e.attrs[t].values.indexOf(a.toLowerCase()))&&(c={index:n,name:r=e.attrs[t].name[n]}):(n=a,"undefined"!==typeof(r=e.attrs[t].values[a])&&(c={index:n,name:r})),e.attrs[t].colorMap&&(c.value=e.attrs[t].colorMap[c.name]),c}},{key:"getKey",value:function(e,t,a,n){return"".concat(e).concat(t).concat(a).concat(n)}},{key:"shuffleArray",value:function(e){console.log("Shuffling cards");for(var t=e.length-1;t>=0;t--){var a=Math.floor(Math.random()*(t+1)),n=e[a];e[a]=e[t],e[t]=n}return e}}]),e}();v.attrs=[{name:"color",values:["green","purple","red"],colorMap:{green:"#00C000",purple:"#C000C0",red:"#FF0000"}},{name:"count",values:["1","2","3"],isColor:!1},{name:"shape",values:["diamond","oval","rectangle"],isColor:!1},{name:"pattern",values:["empty","striped","solid"],isColor:!1}],v.attrNames=v.attrs.map(function(e){return e.name}),v.colorAttr=v.attrs.filter(function(e){return"undefined"!==typeof e.colorMap}),v.getMatchingAttrs=function(e,t){var a=v.attrNames,n=e.length;if(n<1)return[];if(1===n)return a;for(var r={attrs:[null,null,null,null],matchingAttrs:[],count:null},c=e[0],s=1;s<n;s++){var o=e[s];if(0===(r=v.getMatches(c,o,r)).count)break}return r.matchingAttrs};var p=function(){return{type:"DEAL_CARDS"}},b=function(){return{type:"CHECK_GAME_OVER"}},g=function(e){return{type:"CARD_FLIPPED",cardKey:e}},E=function(e){return{type:"CHECK_MATCHES",tableCards:e}},C=function(e){return{type:"UPDATE_SCORE_FROM_MATCHES",tableCards:e}},O=function(){return{type:"KEEP_SCORE"}},y=function(){return{type:"RESET_FLIPPED_CARDS"}},k=function(){return{type:"CLEAR_KEPT_CARDS"}};function j(e){return function(t,a){var n=a().score,r=n.tableCards,c=n.possPoints;v.getCardFromKey(r,e).faceDown?t(function(e){return function(t,a){t(g(e));var n=a().score.tableCards;t(E(n));var r=a().score.matchingAttrs;t(C(n));var c=v.getSelectedCards(n),s=1===c.length||r.length>0;s||(t(h()),setTimeout(function(){t(y()),t(f())},2e3))}}(e)):c>0&&t(A())}}function A(){return function(e){e(O()),e(k()),e(h()),setTimeout(function(){e(p()),e(b()),e(f())},300)}}var w=function(e){function t(){return Object(o.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"onKeepButtonClick",value:function(){this.props.dispatch(A())}},{key:"render",value:function(){var e=this.props.score,t=e.possPoints,a=e.matchingAttrs,n=a?a.join(", "):"",c=this.props.score.deckCards.length;return r.a.createElement("div",{className:"SharedStatus"},r.a.createElement("div",{className:"status-section cards-area"},r.a.createElement("span",{className:"statusTitle ui label"},"Cards Left: "),r.a.createElement("span",{className:"status-count ui basic label"},c)),r.a.createElement("div",{className:"status-section posspoints-area"},r.a.createElement("span",{className:"statusTitle ui label"},"Possible Points: "),r.a.createElement("div",{className:""},r.a.createElement("button",{className:"ui button primary keep-button",tabIndex:"0",disabled:0===t,title:"Keep the possible points. Also you can click on a flipped up card in the set to keep them.",onClick:this.onKeepButtonClick.bind(this)},"Keep"),r.a.createElement("span",{className:"status-count ui basic label"},t))),r.a.createElement("div",{className:"status-section matching-attrs-area"},r.a.createElement("span",{className:"statusTitle ui label"},"Matches: "),r.a.createElement("span",{className:"matching-attrs ui label"},n)))}}]),t}(n.Component);var _=Object(m.connect)(function(e){return{common:e.common,score:e.score}})(w),S=function(e){function t(){return Object(o.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.user,a=e.sets,n=e.points,c=e.isActive;return r.a.createElement("div",{className:"UserScore","data-isactive":c},r.a.createElement("div",{className:"status-section userArea"},r.a.createElement("span",{className:"statusTitle ui label"},t)),r.a.createElement("div",{className:"status-section setsArea"},r.a.createElement("span",{className:"statusTitle ui label"},"Sets: "),r.a.createElement("span",{className:"status-count ui basic label"},a)),r.a.createElement("div",{className:"status-section points-area"},r.a.createElement("span",{className:"statusTitle ui label"},"Points: "),r.a.createElement("span",{className:"status-count ui basic label"},n)))}},{key:"componentDidUpdate",value:function(e,t,a){var n=this.props.isActive;if(console.log("componentDidUpdate: isActive="+n),n){var r=s.a.findDOMNode(this);console.log("componentDidUpdate: domNode="),console.log(r),window.setTimeout(function(){r.scrollIntoView({behavior:"smooth",block:"end",inline:"end"})},100)}}}]),t}(n.Component),N=function(e){function t(){return Object(o.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"getUserScores",value:function(){var e=this;return this.props.score.userScores.map(function(t,a){var n=t.user,c=t.sets,s=t.points,o=e.props.score.activeUserIndex===a;return r.a.createElement(S,{key:a,user:n,sets:c,points:s,isActive:o})})}},{key:"render",value:function(){var e=this.getUserScores();return r.a.createElement("div",{className:"StatusArea"},r.a.createElement(_,null),e)}}]),t}(n.Component);var R=Object(m.connect)(function(e){return{common:e.common,score:e.score}})(N),D=a(35),T=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).handleClick=a.handleClick.bind(Object(D.a)(Object(D.a)(a))),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"handleClick",value:function(){this.props.dispatch(j(this.props.cardKey))}},{key:"render",value:function(){var e=v.decodeAttr(0,this.props.attr1),t=v.decodeAttr(1,this.props.attr2),a=v.decodeAttr(2,this.props.attr3),n=v.decodeAttr(3,this.props.attr4),c=this.props,s=c.isEmpty,o=c.faceDown,l=c.highlight,i="".concat(e.name," ").concat(t.name," ").concat(a.name," ").concat(n.name),u="".concat(e.name,"-").concat(t.name,"-").concat(a.name,"-").concat(n.name,".png");if(s){return r.a.createElement("div",{className:"Card is-empty"},r.a.createElement("img",{alt:"",src:"images/cards/brave/CardEmpty.png"}))}var d="card back",m="images/cards/brave/CardBack.png";return o||(d=i,m="images/cards/brave/".concat(u)),o?r.a.createElement("div",{className:"Card "+l,"data-facedown":o,onClick:this.handleClick},r.a.createElement("img",{src:m,alt:d})):r.a.createElement("div",{className:"Card "+l,"data-facedown":o,"data-card-label":i,onClick:this.handleClick},r.a.createElement("img",{src:m,alt:d}),r.a.createElement("div",{className:"card-label"}))}}]),t}(n.Component);var P=Object(m.connect)(function(e){return{common:e.common,highlight:e.score.highlight}})(T);var M=Object(m.connect)(function(e){return{common:e.common}})(function(e){return e.common.overlayShown?r.a.createElement("div",{className:"Overlay"}):null}),K=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).getCards=function(){a.cards=[],a.props.score.tableCards.forEach(function(e,t){var n=null;if(e){var c=e.key,s=e.attrs,o=e.faceDown;s&&4===s.length?n=r.a.createElement("div",{key:t+"."+c,className:"Table_grid_item"},r.a.createElement(P,{cardKey:c,attr1:s[0],attr2:s[1],attr3:s[2],attr4:s[3],faceDown:o})):(console.log("cardInfo @ index "+t+" = "),console.log(e))}n||(n=r.a.createElement("div",{key:t+".empty",className:"Table_grid_item"},r.a.createElement(P,{isEmpty:!0}))),a.cards.push(n)})},a.cards=null,a.props.deckCards||a.props.dispatch(p()),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return this.getCards(),this.props.score.gameOver?r.a.createElement("div",{className:"Table"},r.a.createElement(M,null),r.a.createElement("div",{className:"game-over-message"},"Congratulations!",r.a.createElement("br",null),"All possible combinations have been played!"),r.a.createElement("button",{className:"ui button primary new-game-button",onClick:function(){document.location.reload()}},"New Game")):r.a.createElement("div",{className:"Table"},r.a.createElement(M,null),r.a.createElement("div",{className:"Table_grid"},this.cards))}}]),t}(n.Component);var x=Object(m.connect)(function(e){return{common:e.common,score:e.score}})(K),L=a(140),I=a.n(L),U=a(141),H=a.n(U),F=a(48),V=Object(F.createDevTools)(r.a.createElement(H.a,{toggleVisibilityKey:"ctrl-x",changePositionKey:"ctrl-z",defaultIsVisible:!1,defaultPosition:"left"},r.a.createElement(I.a,{theme:"tomorrow"}))),B=a(15),W=a(142),G=a(143),Y=a(9),J={error:null,overlayShown:!1},z=a(144),Q=a(36),$={tableCards:[],deckCards:[],matchingAttrs:[],userScores:[{user:"Player 1",sets:0,points:0},{user:"Player 2",sets:0,points:0}],activeUserIndex:0,possPoints:0,highlight:"none",gameOver:!1},q={common:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_ERROR":return e=Object(Y.a)({},e,{error:t.error});case"CLEAR_ERROR":return e=Object(Y.a)({},e,{error:null});case"SHOW_OVERLAY":return e=Object(Y.a)({},e,{overlayShown:!0});case"HIDE_OVERLAY":return e=Object(Y.a)({},e,{overlayShown:!1});default:return e}},score:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$,t=arguments.length>1?arguments[1]:void 0,a=Object(Y.a)({},e);switch(t.type){case"TEST_REMOVE_BUNCH_OF_CARDS":var n=Math.floor(Math.random()*e.tableCardsCount)+1;console.log("TEST_REMOVE_BUNCH_OF_CARDS: ".concat(n)),a.tableCards.forEach(function(e,t){null!==e&&n-- >0&&(a.tableCards[t]=Object(Y.a)({},e,{index:t,faceDown:!1}))});break;case"DEAL_CARDS":var r=e.deckCards;0===e.tableCards.length?(a.tableCards=new Array(20).fill(null),0===r.length&&(a.deckCards=v.shuffleDeckCards(),r=a.deckCards)):a.tableCards=Object(Q.a)(e.tableCards);var c=0;a.tableCards.forEach(function(e,t){if(null===e){if(r.length>0){var n=r.splice(0,1),s=Object(z.a)(n,1)[0];a.tableCards[t]=Object(Y.a)({},s,{index:t}),c++}}else c++}),a.tableCardsCount=c;break;case"CHECK_GAME_OVER":if(a.gameOver=e.tableCardsCount<2,!a.gameOver){for(var s=!1,o=e.tableCards.length,l=0;l<o&&!s;l++){var i=e.tableCards[l];if(i)for(var u=l+1;u<o&&!s;u++){var d=e.tableCards[u];if(d){console.log("CHECK_GAME_OVER: card1: "),console.log(i),console.log("CHECK_GAME_OVER: card2: "),console.log(d);var m=[i,d],h=v.getMatchingAttrs(m);h&&h.length>0&&(s=!0)}}}a.gameOver=!s}break;case"CARD_FLIPPED":var f=t.cardKey,p=e.tableCards,b=v.getCardFromKey(p,f);if(null!=b){var g=Object(Q.a)(p),E=Object(Y.a)({},b,{faceDown:!b.faceDown});g[E.index]=E,a.tableCards=g}break;case"CHECK_MATCHES":var C=t.tableCards,O=v.getSelectedCards(C),y=Object.keys(O).length,k=v.getMatchingAttrs(O),j=k.length>0;a.highlight=j?"highlight-match":"highlight-mismatch",a.matchingAttrs=j&&y>1?k:[];break;case"UPDATE_SCORE_FROM_MATCHES":var A=t.tableCards,w=v.getSelectedCards(A);if(e.matchingAttrs.length>0){var _=Object.keys(w).length,S=_*_;a.possPoints=S}else a.possPoints=0;break;case"KEEP_SCORE":var N=e.activeUserIndex,R=Object(Y.a)({},e.userScores[N]);"undefined"!==typeof a.possPoints&&(R.points+=e.possPoints,R.sets++,a.userScores=Object(Q.a)(e.userScores),a.userScores[N]=R),a.activeUserIndex=(N+1)%2,a.possPoints=0,a.matchingAttrs=[],a.highlight="none";break;case"RESET_FLIPPED_CARDS":a.possPoints=0,a.matchingAttrs=[],a.tableCards=e.tableCards.map(function(e){return e?Object(Y.a)({},e,{faceDown:!0}):null}),a.activeUserIndex=(e.activeUserIndex+1)%2;break;case"CLEAR_KEPT_CARDS":var D=e.tableCards,T=v.getSelectedCards(D),P=Object(Q.a)(D);T.forEach(function(e){P[e.index]=null}),a.tableCards=P}return a}},X=Object(B.c)(q),Z=Object(W.createLogger)(),ee=Object(B.d)(Object(B.a)(G.a,Z),V.instrument());var te=function(e){function t(e){var a,n;return Object(o.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).store=Object(B.e)(X,n,ee),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(m.Provider,{store:this.store},r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-header"},r.a.createElement(R,null)),r.a.createElement(V,null),r.a.createElement(x,null)))}}]),t}(n.Component),ae=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function ne(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}s.a.render(r.a.createElement(te,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/brave",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("/brave","/service-worker.js");ae?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):ne(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):ne(e)})}}()}},[[145,2,1]]]);
//# sourceMappingURL=main.b19a5d0e.chunk.js.map